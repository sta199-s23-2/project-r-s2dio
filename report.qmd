---
title: "Project R-S2dio - College Basketball"
subtitle: "Report"
format: html
editor: visual
execute:
  echo: true
---

```{r}
#| label: load-packages

library(tidyverse)
library(tidymodels)
```

```{r}
#| label: read-csv

cbb <- read_csv("data/cbb.csv")
```

**Dataset 2 (D1 college basketball)**

**Introduction and data**

As Duke students, it goes without saying that Duke basketball adds on to our unique college experience. Noting Duke mens basketball's historical successes, we have grown interested in researching more about other Division 1 mens basketball programs in universities throughout the country.

The data that we will be utilizing is sourced from the Division I college basketball seasons from the years of 2013-2019. It was found in the open source data site, Kaggle. The data was scraped from http://barttorvik.com/trank.php#. This data was cleaned up in 2021, in which the COVID seasons were not included in the dataset.

The dataset has various variables that characterize different Division I basketball teams--- such as the university they represent and the conference in which they belong. Some of the observations within the dataset include the number of games played, the number of games won, power rating, as well as the stats of the team in a particular season.

**Methodology**

**Our research question: "How does regular season adjusted offensive efficiency, and regular season adjusted defensive efficiency correlate to being a 1-seed team and post season success?"**

Our central research question is addressed through the analysis of the factors that best predict overall regular season success from 2013 to 2019. We might be able to filter out the different factors that play a role in each program's success and determine their 'weight' in assigning regular season rankings. This processes is then applied to investigate if such factor better predicts post season success/ pre-season rankings for the next basketball season.

**Results**

-- What are you finding out? We are finding out the correlation between seeds when predicted by adjusted offensive efficiency and adjusted defensive efficiency, as well as finding which predictor is the best (out of adjusted offensive efficiency, adjusted defensive efficiency, or both).

```{r}
#| label: rename-cbb

cbb_new <- cbb |>
  mutate("Total Efficiency" = ADJOE - ADJDE) |>
  filter(SEED != "NA") |>
  rename("Adjusted Offensive Efficiency" = "ADJOE",
    "Effective Field Goal" = "EFG_O", "Wins Above Bubble" = "WAB")
```

Plotting The Data

```{r}
#| label: visualization

cbb |>
  ggplot(aes(x = ADJOE,
             y = SEED)) +
  geom_point() +
  labs(x = "Adjusted Offensve Efficiency", y = "Seed",
       title = 
         "Relationship Between Adjusted 
       Offensive Efficiency and Seed")


cbb |>
  ggplot(aes(x = ADJDE,
             y = SEED)) +
  geom_point() +
  labs(x = "Adjusted Defensive Efficiency", y = "Seed",
       title = 
         "Relationship Between Adjusted 
       Defensive Efficiency and Seed")

cbb_new |>
  ggplot(aes(x = `Total Efficiency`,
             y = SEED)) +
  geom_point() +
  labs(x = "Total Efficiency (Offensive - Defensive)", y = "Seed",
       title = 
         "Relationship Between Total Efficiency and Seed")

#another way to look at the data (not for linear regression)
cbb_new |>
  ggplot(
    aes(x = `Adjusted Offensive Efficiency`,
             y = ADJDE, color = SEED)
         ) +
  geom_point() +
  labs(x = "Adjusted Offensive Efficiency", y = "Adjusted Defensive Efficiency",
       title = "Adjusted Offensive Efficiency, Adjusted Defensive Efficiency
       and End of Regular Season Seed") 

cbb_new |>
  ggplot(
    aes(x = `Adjusted Offensive Efficiency`,
             y = ADJDE, color = SEED)
         ) +
  geom_point(size = 20, alpha = .20) +
  labs(x = "Adjusted Offensive Efficiency", y = "Adjusted Defensive Efficiency",
       title = "Adjusted Offensive Efficiency, Adjusted Defensive Efficiency
       and End of Regular Season Seed") 

```

Fitting Our Models

```{r}
#| lable: linear-reg

SEED_Model_1 <- linear_reg() |>
  set_engine("lm") |>
  fit(SEED ~ ADJOE, data = cbb)

SEED_Model_2 <- linear_reg() |>
  set_engine("lm") |>
  fit(SEED ~ ADJDE, data = cbb)

SEED_Model_3 <- linear_reg() |>
  set_engine("lm") |>
  fit(SEED ~ ADJOE * ADJDE, data = cbb)

SEED_Model_4 <- linear_reg() |>
  set_engine("lm") |>
  fit(SEED ~ `Total Efficiency`, data = cbb_new)

SEED_Model_1
SEED_Model_2
SEED_Model_3
SEED_Model_4

```

Model1 (predicting seed based on adjusted offensive efficiency)

$\widehat{SEED} = 69.90 - 0.55*ADJOE$

Model2 (predicting seed based on adjusted defensive efficiency)

$\widehat{SEED} = -49.52 + 0.60*ADJDE$

Model3 (predicting seed based on adjusted offensive and defensive efficiency)

$\widehat{SEED} = -183.59 - 1.98*ADJOE - 1.29*ADJDE + 0.02*ADJOE*ADJDE$

Finding Adjusted R-Squared

```{r}
#| label: Adjusted-R-Squared

SEED_Model_1 <- linear_reg() |>
  set_engine("lm") |>
  fit(SEED ~ ADJOE, data = cbb) |>
  glance() |>
  pull(adj.r.squared)

SEED_Model_2 <- linear_reg() |>
  set_engine("lm") |>
  fit(SEED ~ ADJDE, data = cbb) |>
  glance() |>
  pull(adj.r.squared)

SEED_Model_3 <- linear_reg() |>
  set_engine("lm") |>
  fit(SEED ~ ADJOE * ADJDE, data = cbb) |>
  glance() |>
  pull(adj.r.squared)

SEED_Model_4 <- linear_reg() |>
  set_engine("lm") |>
  fit(SEED ~ `Total Efficiency`, data = cbb_new)|>
  glance() |>
  pull(adj.r.squared)

SEED_Model_1
SEED_Model_2
SEED_Model_3
SEED_Model_4

```

Finding AIC (Akaike Information Criterion)

```{r}
#| label: AIC

SEED_Model_1 <- linear_reg() |>
  set_engine("lm") |>
  fit(SEED ~ ADJOE, data = cbb) |>
  glance() |>
  pull(AIC)

SEED_Model_2 <- linear_reg() |>
  set_engine("lm") |>
  fit(SEED ~ ADJDE, data = cbb) |>
  glance() |>
  pull(AIC)

SEED_Model_3 <- linear_reg() |>
  set_engine("lm") |>
  fit(SEED ~ ADJOE * ADJDE, data = cbb) |>
  glance() |>
  pull(AIC)

SEED_Model_4 <- linear_reg() |>
  set_engine("lm") |>
  fit(SEED ~ `Total Efficiency`, data = cbb_new)|>
  glance() |>
  pull(AIC)

SEED_Model_1
SEED_Model_2
SEED_Model_3
SEED_Model_4

```

The interactive model (with both adjusted offensive and defensive efficiency) is the best model with the highest adjusted r -squared value. Adjusted offensive efficiency is the second best predictor closely followed by defensive efficiency (but both are individually less correlated with their seed). This means that between offensive and defensive efficiency is slightly more important when it comes to seeding, but both combined are the most important when it comes to predicting seed. These results do match our hypothesis which again is "We predicted that, in regular season, teams with higher adjusted offensive efficiency & lower adjusted defensive efficiency were likelier to be 1-seed teams and make later playoff rounds."
